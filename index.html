<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LLM Agent POC</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body { background: #f6f8fb; }
      .chat-container { height: 55vh; overflow-y: auto; background: #fff; border: 1px solid #e5e7eb; border-radius: .5rem; padding: 1rem; }
      .msg { margin-bottom: .75rem; }
      .msg .role { font-weight: 600; margin-right: .5rem; }
      .msg.assistant { background: #fafafa; border-radius: .5rem; padding: .5rem .75rem; }
      .msg.user { text-align: right; }
      .msg.user .bubble { display: inline-block; background: #0d6efd; color: #fff; border-radius: .5rem; padding: .5rem .75rem; }
      .msg.tool { font-size: .9rem; color: #495057; }
      .settings .form-text { font-size: .8rem; }
      .streaming-cursor { display: inline-block; width: 8px; background: #111; animation: blink 1s step-start 0s infinite; height: 1rem; vertical-align: text-bottom; }
      @keyframes blink { 50% { opacity: 0; } }
      .small-mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: .85rem; }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <div class="d-flex align-items-center mb-3">
        <h2 class="me-auto">LLM Agent (Browser POC)</h2>
        <button id="clearBtn" class="btn btn-outline-secondary btn-sm">Clear</button>
      </div>

      <div id="alerts" class="mb-3"></div>

      <div class="card shadow-sm mb-3 settings">
        <div class="card-body">
          <div class="row g-3 align-items-end">
            <div class="col-md-3">
              <label class="form-label">Provider</label>
              <select id="provider" class="form-select">
                <option value="openai">OpenAI</option>
                <option value="openrouter">OpenRouter</option>
                <option value="groq">Groq</option>
                <option value="ollama">Ollama (local)</option>
                <option value="custom">Custom (OpenAI-compatible)</option>
              </select>
              <button id="pickProviderBtn" type="button" class="btn btn-outline-primary btn-sm mt-2">Pick Providerâ€¦</button>
              <div class="form-text">Uses bootstrap-llm-provider modal.</div>
            </div>
            <div class="col-md-3">
              <label class="form-label">Model</label>
              <input id="model" class="form-control" placeholder="e.g. gpt-4o-mini" value="gpt-4o-mini">
            </div>
            <div class="col-md-3" id="apiKeyWrap">
              <label class="form-label">OpenAI / OpenRouter Key</label>
              <input id="apiKey" class="form-control" placeholder="sk-...">
              <div class="form-text">Stored in-memory only. For demo use.</div>
            </div>
            <div class="col-md-3 d-none" id="customBaseWrap">
              <label class="form-label">Custom Base URL</label>
              <input id="customBaseUrl" class="form-control" placeholder="https://host/v1">
              <div class="form-text">OpenAI-compatible endpoint.</div>
            </div>
          </div>
          <hr>
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Google API Key</label>
              <input id="googleKey" class="form-control" placeholder="AIza...">
              <div class="form-text">For search snippets (CSE).</div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Google CSE CX</label>
              <input id="googleCx" class="form-control" placeholder="custom search engine id">
              <div class="form-text">Programmable Search Engine ID.</div>
            </div>
            <div class="col-md-4">
              <label class="form-label">AI Pipe Endpoint</label>
              <input id="aipipeUrl" class="form-control" placeholder="https://aipipe.example.com/run">
              <div class="form-text">Flexible dataflow proxy.</div>
              <input id="aipipeToken" class="form-control mt-2" placeholder="AI Pipe Token (optional)">
            </div>
          </div>
        </div>
      </div>

      <div id="chat" class="chat-container small-mono mb-3"></div>

      <form id="inputForm" class="card shadow-sm">
        <div class="card-body">
          <div class="mb-2">
            <label for="userInput" class="form-label">Message</label>
            <textarea id="userInput" class="form-control" rows="3" placeholder="Ask the agent..."></textarea>
          </div>
          <div class="d-flex gap-2">
            <button id="sendBtn" type="submit" class="btn btn-primary">Send</button>
            <button id="stopBtn" type="button" class="btn btn-outline-danger" disabled>Stop</button>
          </div>
        </div>
      </form>

      <iframe id="sandbox" src="./sandbox.html" sandbox="allow-scripts" class="d-none"></iframe>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="./agent.js"></script>
  </body>
  </html>


